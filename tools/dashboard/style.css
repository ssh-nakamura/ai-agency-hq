/* ── Reset & Base ── */
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', sans-serif;
    background: #0f0f0f; color: #e0e0e0;
    height: 100vh; display: flex; flex-direction: column; overflow: hidden;
}

/* ── Top Nav ── */
.topnav {
    background: #1a1a1a; border-bottom: 1px solid #2a2a2a;
    display: flex; align-items: center; padding: 0 16px; height: 48px; flex-shrink: 0;
}
.topnav-brand { font-weight: 800; color: #fff; font-size: 15px; margin-right: 24px; letter-spacing: -.02em; }
.topnav-tabs { display: flex; gap: 2px; }
.tab-btn {
    padding: 10px 18px; border: none; background: none; color: #888;
    font-size: 13px; font-weight: 600; cursor: pointer;
    border-bottom: 2px solid transparent; transition: all .15s;
}
.tab-btn:hover { color: #ccc; }
.tab-btn.active { color: #fff; border-bottom-color: #5b8def; }
.topnav-right { margin-left: auto; display: flex; align-items: center; gap: 8px; }
.status-dot { width: 7px; height: 7px; border-radius: 50%; background: #ef4444; }
.status-dot.ok { background: #22c55e; box-shadow: 0 0 4px #22c55e80; }
.status-dot.warn { background: #eab308; box-shadow: 0 0 4px #eab30880; }
.status-text { font-size: 11px; color: #888; }

/* ── Tab Panels ── */
.tab-panel { display: none; flex: 1; overflow: hidden; }
.tab-panel.active { display: flex; }

/* ── OVERVIEW TAB ── */
.overview-scroll { flex: 1; overflow-y: auto; padding: 24px 32px; max-width: 1100px; margin: 0 auto; width: 100%; }

.kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 14px; margin-bottom: 24px; }
.kpi { background: #1a1a1a; border-radius: 10px; padding: 16px; border: 1px solid #2a2a2a; }
.kpi-label { font-size: 11px; color: #888; text-transform: uppercase; letter-spacing: .04em; margin-bottom: 6px; }
.kpi-val { font-size: 24px; font-weight: 700; color: #fff; }
.kpi-sub { font-size: 11px; color: #555; margin-top: 2px; }

.section { background: #1a1a1a; border-radius: 10px; padding: 16px 20px; border: 1px solid #2a2a2a; margin-bottom: 16px; }
.section-title { font-size: 13px; font-weight: 700; color: #fff; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
.section-title .badge {
    font-size: 10px; padding: 2px 8px; border-radius: 8px; font-weight: 600;
}
.badge-ok { background: #16653420; color: #4ade80; }
.badge-ng { background: #ef444420; color: #f87171; }
.badge-warn { background: #eab30820; color: #facc15; }

.check-row { display: flex; align-items: center; gap: 10px; padding: 5px 0; font-size: 13px; }
.check-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.check-dot.ok { background: #22c55e; }
.check-dot.ng { background: #ef4444; }
.check-dot.warn { background: #eab308; }
.check-label { color: #ccc; }
.check-detail { color: #666; margin-left: auto; font-size: 11px; }

.action-table { width: 100%; font-size: 13px; border-collapse: collapse; }
.action-table th { text-align: left; color: #888; font-size: 11px; font-weight: 600; padding: 4px 8px; border-bottom: 1px solid #2a2a2a; }
.action-table td { padding: 6px 8px; border-bottom: 1px solid #1e1e1e; color: #ccc; }
.action-table .id { color: #5b8def; font-weight: 600; white-space: nowrap; }
.action-table .status { font-size: 11px; padding: 2px 8px; border-radius: 8px; font-weight: 600; }
.s-pending { background: #33333320; color: #888; }
.s-done { background: #16653420; color: #4ade80; }
.s-hold { background: #78350f20; color: #fbbf24; }

.log-content { font-size: 12px; color: #999; line-height: 1.6; white-space: pre-wrap; max-height: 200px; overflow-y: auto; }

.two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }

/* ── AGENTS TAB ── */
.agents-layout { display: flex; flex: 1; overflow: hidden; }

.sidebar {
    width: 260px; background: #141414; border-right: 1px solid #2a2a2a;
    overflow-y: auto; flex-shrink: 0;
}
.sidebar-header { padding: 12px 16px 8px; font-size: 11px; font-weight: 700; color: #666; text-transform: uppercase; letter-spacing: .06em; }
.sidebar-item { display: flex; align-items: center; gap: 10px; padding: 8px 16px; cursor: pointer; transition: background .1s; }
.sidebar-item:hover { background: #1e1e1e; }
.sidebar-item.active { background: #1e293b; }
.si-avatar { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 700; color: #fff; flex-shrink: 0; }
.si-team-avatar { width: 32px; height: 32px; border-radius: 10px; background: #1e3a5f; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
.si-info { flex: 1; min-width: 0; }
.si-name { font-size: 13px; font-weight: 600; color: #e0e0e0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.si-sub { font-size: 11px; color: #666; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.si-badge { font-size: 10px; padding: 1px 6px; border-radius: 8px; background: #5b8def20; color: #5b8def; font-weight: 600; flex-shrink: 0; }

.chat-panel { flex: 1; display: flex; flex-direction: column; overflow: hidden; background: #0f0f0f; }
.chat-header { padding: 12px 24px; border-bottom: 1px solid #2a2a2a; display: flex; align-items: center; gap: 12px; flex-shrink: 0; background: #141414; }
.ch-avatar { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: 700; color: #fff; }
.ch-info h3 { font-size: 15px; font-weight: 700; color: #fff; }
.ch-info p { font-size: 12px; color: #888; }
.ch-meta { margin-left: auto; font-size: 11px; color: #555; text-align: right; }
.toggle-row { padding: 6px 24px; border-bottom: 1px solid #1a1a1a; display: flex; gap: 8px; background: #111; }
.toggle-btn { padding: 3px 12px; border-radius: 12px; font-size: 11px; border: 1px solid #333; background: none; color: #888; cursor: pointer; }
.toggle-btn.active { background: #5b8def; color: #fff; border-color: #5b8def; }
.chat-body { flex: 1; overflow-y: auto; padding: 16px 24px 24px; }
.chat-empty { display: flex; align-items: center; justify-content: center; flex: 1; color: #555; font-size: 14px; }
.hide-tools .msg-tool { display: none; }

/* ── Message Bubbles ── */
.msg-row { display: flex; gap: 8px; margin-bottom: 4px; max-width: 85%; }
.msg-row.right { margin-left: auto; flex-direction: row-reverse; }
.msg-row.continued { margin-top: -2px; }

.msg-avatar {
    width: 28px; height: 28px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 11px; font-weight: 700; color: #fff; flex-shrink: 0; margin-top: 2px;
}
.msg-avatar.hidden { visibility: hidden; }

.msg-content { max-width: 100%; }
.msg-name { font-size: 11px; font-weight: 700; margin-bottom: 2px; display: flex; align-items: center; gap: 6px; }
.msg-name .ts { font-weight: 400; color: #555; font-size: 10px; }
.msg-row.right .msg-name { justify-content: flex-end; }

.bubble {
    padding: 8px 14px; border-radius: 18px; font-size: 13.5px; line-height: 1.55;
    word-break: break-word; white-space: pre-wrap; max-width: 100%;
}
.bubble.left { background: #1e1e1e; border-top-left-radius: 4px; color: #e0e0e0; }
.bubble.right { background: #1a3a5c; border-top-right-radius: 4px; color: #d8e8ff; }

.msg-tool { padding: 1px 0 1px 36px; font-size: 11px; color: #555; }
.msg-tool .tn { color: #5b8def; font-weight: 500; }

/* ── ROADMAP TAB ── */
.roadmap-scroll { flex: 1; overflow-y: auto; padding: 32px; max-width: 960px; margin: 0 auto; width: 100%; }

.phase { background: #1a1a1a; border-radius: 12px; margin-bottom: 24px; overflow: hidden; border: 1px solid #2a2a2a; }
.phase-head { padding: 16px 24px; display: flex; align-items: center; gap: 14px; }
.phase-num { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 800; color: #fff; }
.phase-info h3 { font-size: 16px; font-weight: 700; color: #fff; }
.phase-tag { margin-left: auto; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 600; }
.step { border-top: 1px solid #2a2a2a; padding: 14px 24px; }
.step-name { font-size: 13px; font-weight: 600; color: #e0e0e0; margin-bottom: 10px; }
.task-row { display: flex; align-items: center; gap: 8px; padding: 4px 0; font-size: 13px; }
.task-name { flex: 1; color: #ccc; }
.task-assignee { font-size: 11px; color: #888; min-width: 80px; }
.task-status { font-size: 11px; padding: 2px 8px; border-radius: 8px; font-weight: 600; }
.arrow { text-align: center; color: #444; font-size: 20px; padding: 4px 0; }

/* ── USAGE TAB ── */
.usage-scroll { flex: 1; overflow-y: auto; padding: 32px; max-width: 1100px; margin: 0 auto; width: 100%; }
.usage-banner { background: #1e3a5f; border: 1px solid #2563eb40; border-radius: 10px; padding: 10px 16px; margin-bottom: 20px; font-size: 13px; color: #93c5fd; }
.usage-banner.err { background: #3b1212; border-color: #ef444440; color: #fca5a5; }

/* ── RESEARCH TAB ── */
.research-layout { display: flex; flex: 1; overflow: hidden; }
.research-layout .sidebar { width: 280px; }

.research-file-icon {
    width: 32px; height: 32px; border-radius: 6px; background: #1e3a5f;
    flex-shrink: 0; display: flex; align-items: center; justify-content: center;
}
.research-file-icon::after { content: ""; display: block; width: 14px; height: 16px; border: 2px solid #5b8def; border-radius: 2px; }

.research-main {
    flex: 1; overflow-y: auto; background: #0f0f0f; padding: 32px;
    display: flex; justify-content: center;
}
.research-main .chat-empty { width: 100%; }

.research-reader { max-width: 800px; width: 100%; }
.research-title { font-size: 22px; font-weight: 700; color: #fff; margin-bottom: 8px; }
.research-meta { font-size: 12px; color: #555; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 1px solid #2a2a2a; }

.research-body { line-height: 1.7; color: #d0d0d0; font-size: 14px; }
.research-body h1 { font-size: 20px; font-weight: 700; color: #fff; margin: 28px 0 12px; }
.research-body h2 { font-size: 17px; font-weight: 700; color: #fff; margin: 24px 0 10px; border-bottom: 1px solid #2a2a2a; padding-bottom: 6px; }
.research-body h3 { font-size: 15px; font-weight: 600; color: #e0e0e0; margin: 20px 0 8px; }
.research-body p { margin: 8px 0; }
.research-body strong { color: #fff; font-weight: 600; }
.research-body a { color: #5b8def; text-decoration: none; }
.research-body a:hover { text-decoration: underline; }
.research-body code { background: #1a1a1a; padding: 1px 5px; border-radius: 3px; font-size: 13px; color: #e0e0e0; font-family: 'SF Mono', 'Fira Code', Consolas, monospace; }
.research-body pre { background: #141414; border: 1px solid #2a2a2a; border-radius: 8px; padding: 14px 18px; margin: 12px 0; overflow-x: auto; }
.research-body pre code { background: none; padding: 0; font-size: 13px; line-height: 1.5; }
.research-body ul { margin: 8px 0; padding-left: 20px; }
.research-body li { margin: 4px 0; }
.research-body blockquote { border-left: 3px solid #5b8def; padding: 4px 14px; margin: 10px 0; color: #999; background: #1a1a1a20; }
.research-body hr { border: none; border-top: 1px solid #2a2a2a; margin: 20px 0; }

.research-body table { width: 100%; border-collapse: collapse; margin: 12px 0; font-size: 13px; }
.research-body th { background: #1a1a1a; color: #ccc; font-weight: 600; text-align: left; padding: 8px 12px; border: 1px solid #2a2a2a; }
.research-body td { padding: 6px 12px; border: 1px solid #2a2a2a; color: #ccc; }
.research-body tr:hover td { background: #1a1a1a40; }

/* ── NICHE TAB ── */
.niche-layout { display: flex; flex: 1; overflow: hidden; }
.niche-layout .sidebar { width: 260px; }
.niche-main { flex: 1; overflow-y: auto; background: #0f0f0f; padding: 24px 32px; }
.sidebar-subheader { padding: 10px 16px 4px; font-size: 12px; font-weight: 600; color: #5b8def; }
.report-btn {
    background: #1e3a5f; border: 1px solid #2a5080; color: #7bb8f0; font-size: 11px;
    padding: 2px 8px; border-radius: 4px; cursor: pointer; font-weight: 600; white-space: nowrap;
}
.report-btn:hover { background: #264d7a; color: #a0d0ff; }
.niche-icon { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0; }

.niche-detail { max-width: 900px; margin: 0 auto; }
.niche-header h2 { font-size: 20px; font-weight: 700; color: #fff; }
.niche-meta { font-size: 12px; color: #555; margin-top: 4px; margin-bottom: 16px; }

.niche-overall {
    background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 12px;
    padding: 16px 20px; margin-bottom: 16px; display: flex; align-items: center; gap: 16px;
}
.niche-score { font-size: 32px; font-weight: 800; }
.niche-bar-wrap { flex: 1; height: 8px; background: #2a2a2a; border-radius: 4px; overflow: hidden; }
.niche-bar { height: 100%; border-radius: 4px; transition: width .3s; }

.niche-steps-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 16px; }
.niche-step-card { background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 8px; padding: 12px; }
.niche-step-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
.niche-step-head span:first-child { font-size: 12px; font-weight: 600; color: #ccc; }
.niche-step-stars { font-size: 14px; }
.niche-step-comment { font-size: 11px; color: #888; }

.niche-data-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.niche-data-card { background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 10px; padding: 14px 18px; }
.niche-data-card h3 { font-size: 13px; font-weight: 600; color: #fff; margin-bottom: 8px; }
.niche-data-card table { width: 100%; border-collapse: collapse; font-size: 13px; }
.niche-data-card th { text-align: left; color: #888; font-size: 11px; font-weight: 600; padding: 4px 8px; border-bottom: 1px solid #2a2a2a; }
.niche-data-card td { padding: 5px 8px; border-bottom: 1px solid #1e1e1e; color: #ccc; }
.niche-data-card .r { text-align: right; font-variant-numeric: tabular-nums; }
.niche-raw { font-size: 12px; color: #999; white-space: pre-wrap; max-height: 200px; overflow-y: auto; line-height: 1.5; }

@media (max-width: 900px) {
    .niche-steps-grid { grid-template-columns: repeat(2, 1fr); }
    .niche-data-grid { grid-template-columns: 1fr; }
}

/* ── Scrollbar ── */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #2a2a2a; border-radius: 3px; }

@media (max-width: 768px) {
    .kpi-grid { grid-template-columns: repeat(2, 1fr); }
    .two-col { grid-template-columns: 1fr; }
    .sidebar { width: 200px; }
}
